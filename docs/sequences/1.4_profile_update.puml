@startuml

title 1.4 [P1] Profile Update : 회원 프로필 수정

actor "User (Member)" as User
participant "JwtAuthenticationFilter" as Filter
participant "MemberProfileController" as Controller
participant "MemberProfileService" as AppService
participant "Member" as MemberDomain
participant "MemberQueryRepository" as QueryRepo
participant "MemberCommandRepository" as CommandRepo

User -> Controller: POST /api/v1/members/profile
note left: with Authorization header
activate Controller

Controller -> AppService: updateProfile(memberId, request)
note left: memberId is from AuthenticationContextHolder
activate AppService

AppService -> QueryRepo: findById(memberId)
activate QueryRepo
QueryRepo --> AppService: member
deactivate QueryRepo

AppService -> MemberDomain: updateProfile(imageUrl, introduction)
activate MemberDomain
deactivate MemberDomain

AppService -> CommandRepo: save(member)
activate CommandRepo
deactivate CommandRepo

AppService --> Controller: MemberProfileUpdate.Response
deactivate AppService

Controller --> User: 200 OK
deactivate Controller

@enduml
