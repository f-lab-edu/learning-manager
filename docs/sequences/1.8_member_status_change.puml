@startuml

title 1.8 [P2] Member Status Change by Admin: 회원 상태 변경 (회원 활성화/휴면/정지 등)

actor "User (Admin)" as User
participant "CredentialValidator" as Validator
participant "AdminController" as Controller
participant "MemberManagementService" as AppService
participant "Member" as MemberDomain
participant "MemberRepository" as Repository

User -> Controller: Change Member Status
activate Validator
activate Controller
Validator --> User: 401 Unauthorized
Validator --> User: 403 Forbidden
deactivate Validator

Controller -> AppService: changeMemberStatus
activate AppService

AppService -> Repository: findById
activate Repository
Repository --> AppService: member
deactivate Repository

alt newStatus is "ACTIVE"
    AppService -> MemberDomain: activate()
else newStatus is "INACTIVE"
    AppService -> MemberDomain: deactivate()
else newStatus is "BANNED"
    AppService -> MemberDomain: ban()

activate MemberDomain
deactivate MemberDomain

AppService -> Repository: save
activate Repository
deactivate Repository

AppService -> Repository: saveStatusHistory
activate Repository
deactivate Repository

AppService --> Controller: void
deactivate AppService

Controller --> User: 200 OK
deactivate Controller


end
@enduml