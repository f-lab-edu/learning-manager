@startuml

title 3.6 [P0] Course Session List Retrieval : 과정별 세션 목록 조회

actor "User (Course Member)" as User
participant "CredentialValidator" as Validator
participant "SessionController" as Controller
participant "SessionListService" as AppService
participant "SessionQueryRepository" as Repository
participant "TaskExecutor" as Executor

User -> Controller: Get Course Session List
activate Validator
activate Controller
Validator --> User: 401 Unauthorized
deactivate Validator

Controller -> Executor: supplyAsync
activate Executor

Executor -> AppService: getCourseSessionList
activate AppService

alt Course Not Found or Access Denied
    AppService --> Executor: ErrorResponse (404 Not Found or 403 Forbidden)
    deactivate AppService
    Executor --> Controller: Error Response
    deactivate Executor
    Controller --> User: Error Code
    deactivate Controller
else Valid Course Session List Request

AppService -> Repository: findByCourseIdWithFilters
activate Repository
Repository --> AppService: Page<Session>
deactivate Repository

loop for each Session
    AppService -> AppService: toSessionListResponse
    AppService -> AppService: determineSessionStatus
end

AppService --> Executor: Page<SessionListResponse>
deactivate AppService

Executor --> Controller: CompletableFuture<Page<SessionListResponse>>
deactivate Executor

Controller --> User: 200 OK (Async Response)
deactivate Controller

end

@enduml